
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Canais - NomaTV</title>
  <link rel="stylesheet" href="estilo.css" />
</head>
<body>
  <h2>Lista de Canais</h2>
  <div id="lista-canais"></div>
  <script src="script.js"></script>
  <script>
    window.onload = () => {
      const user = localStorage.getItem("xtream_user");
      const pass = localStorage.getItem("xtream_pass");
      if (!user || !pass) return alert("SessÃ£o expirada");

      fetch(`${dns}/player_api.php?username=${user}&password=${pass}&action=get_live_streams`)
        .then(res => res.json())
        .then(canais => {
          const container = document.getElementById("lista-canais");
          canais.forEach(canal => {
            const div = document.createElement("div");
            div.className = "canal";
            div.innerHTML = `<strong>${canal.name}</strong>`;
            div.onclick = () => play(canal.stream_id, user, pass);
            container.appendChild(div);
          });
        });
    };

    function play(id, u, p) {
      const url = `${dns}/live/${u}/${p}/${id}.m3u8`;
      const win = window.open();
      win.document.write(`<video src="${url}" controls autoplay style="width:100%;height:100%"></video>`);
    }
  </script>
</body>
</html>
